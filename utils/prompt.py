def build_prompt(price, bids, asks):
    print("🧠 build_prompt 開始")

    prompt = f"""
あなたはプロの暗号資産トレーダーです。
ETH/JPYの価格・板情報・スプレッドに加え、センチメンタル要素も加味して、
以下のテンプレートに従って、最適な戦略を1つだけ出力してください。

【テンプレート】
---
📊 ETH/JPY 戦略通知（リアルタイム）

- 💰 現在価格：{price}円  
- 📉 板情報：買い板 {bids[0]['price']}円 ／ 売り板 {asks[0]['price']}円  
- 📏 スプレッド：{float(asks[0]['price']) - float(bids[0]['price'])}円  
- 📈 戦略判断：（ロングエントリー／ショートエントリー／様子見）から1つを必ず選んで明示  
- 🎯 目標利確ライン：◯◯円  
- ⛑️ 想定ロスカットライン：◯◯円  

🧠 理由：市場の流動性、板の厚さ、スプレッド、ローソク足の形状、MACDのクロス、ニュース、センチメント（Fear & Greed Indexなど）を総合的に考慮して、戦略判断の根拠をわかりやすく1〜2文で説明してください。
---

【補足データ】
- 板情報（上位3件）:
    🟩 Bids（買い板）: {bids[:3]}
    🟥 Asks（売り板）: {asks[:3]}

- 各板のスプレッド：{float(asks[0]['price']) - float(bids[0]['price'])}円

※あなたの出力内容には、上記テンプレート以外は含めずに出力してください。
"""
    return prompt.strip()
